

  

Â  **ä¸€ã€è¿å"ç¦æ­¢çŒœæµ‹"è¦æ±‚çš„æ–‡ä»¶æ±‡æ€»**

  

Â  **ğŸ”´ ä¸¥é‡é—®é¢˜ - æ ¸å¿ƒæœåŠ¡æ–‡ä»¶**

  

Â  | æ–‡ä»¶Â  Â  Â  Â  Â  Â  Â  Â  | è¡Œå·Â  Â  | é—®é¢˜ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | è¿åè¦æ±‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  |---------------------|---------|----------------------------------------------------------------|-------------------------------|

Â  | **capsule_api.py**Â  Â  Â  | 76-91 Â  | CONFIG_DIR/EXPORT_DIR/RESOURCE_DIR æœ‰ fallback åˆ°é»˜è®¤å€¼Â  Â  Â  Â  | âŒ ç¦æ­¢ fallbackÂ  Â  Â  Â  Â  Â  Â  |

Â  | **capsule_api.py**Â  Â  Â  | 91Â  Â  Â  | RESOURCE_DIR = Path(__file__).parent Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **capsule_api.py**Â  Â  Â  | 174-176 | SCRIPT_DIR = Path(__file__).parent.resolve() Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **capsule_api.py**Â  Â  Â  | 176 Â  Â  | CAPSULE_ROOT = Path(os.getenv('CAPSULE_ROOT')) else SCRIPT_DIR | âŒ ç¦æ­¢ fallbackÂ  Â  Â  Â  Â  Â  Â  |

Â  | **capsule_scanner.py**Â  | 22-64 Â  | get_output_dir() å¤šå±‚ fallback é€»è¾‘Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ å¤šå±‚çŒœæµ‹ Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  | **capsule_scanner.py**Â  | 19Â  Â  Â  | Path(__file__).parent åœ¨ fallback ä¸­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **anchor_editor_v2.py** | 39-42 Â  | BASE_DIR = Path(__file__).parent Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **anchor_editor_v2.py** | 42Â  Â  Â  | ç¡¬ç¼–ç  BASE_DIR.parent / "webapp"Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ç¡¬ç¼–ç è·¯å¾„ Â  Â  Â  Â  Â  Â  |

Â  | **capsule_db.py** Â  Â  Â  | 76Â  Â  Â  | current_dir = Path(__file__).parentÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **capsule_db.py** Â  Â  Â  | 1816Â  Â  | current_dir = Path(__file__).parentÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **utils.py**Â  Â  Â  Â  Â  Â  | 29Â  Â  Â  | base_path = Path(__file__).parentÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **auth.py** Â  Â  Â  Â  Â  Â  | 512 Â  Â  | current_dir = Path(__file__).parentÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **sync_service.py** Â  Â  | 1299Â  Â  | current_dir = Path(__file__).parentÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

  

Â  **ğŸŸ¡ ä¸­ç­‰é—®é¢˜ - Routes æ¨¡å—**

  

Â  | æ–‡ä»¶ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | è¡Œå·Â  Â  | é—®é¢˜ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | è¿åè¦æ±‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  |--------------------------|---------|----------------------------------------------------|-------------------------------|

Â  | **routes/library_routes.py** | 25Â  Â  Â  | sys.path.append(str(Path(__file__).parent.parent)) | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **routes/library_routes.py** | 34-36 Â  | ä» common å¯¼å…¥ EXPORT_DIRï¼Œæœ‰ fallback Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ fallbackÂ  Â  Â  Â  Â  Â  Â  |

Â  | **routes/sync_routes.py**Â  Â  | 27Â  Â  Â  | sys.path.append(str(Path(__file__).parent.parent)) | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **routes/sync_routes.py**Â  Â  | 364 Â  Â  | base_dir = Path(__file__).parent.parentÂ  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **routes/sync_routes.py**Â  Â  | 370-380 | æœç´¢å¤šä¸ªå¯èƒ½çš„å¯¼å‡ºç›®å½•ï¼ˆçŒœæµ‹ï¼‰ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢çŒœæµ‹ Â  Â  Â  Â  Â  Â  Â  Â  Â  |

  

Â  **ğŸŸ¡ ä¸­ç­‰é—®é¢˜ - Exporters æ¨¡å—**

  

Â  | æ–‡ä»¶Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | è¡Œå·Â  | é—®é¢˜ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | è¿åè¦æ±‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  |-------------------------------------|-------|----------------------------------------------|-------------------------------|

Â  | **exporters/reaper_bridge.py**Â  Â  Â  Â  Â  | 40-45 | çŒœæµ‹ Lua è„šæœ¬ä½ç½®ï¼ˆå¤šä¸ªå¯èƒ½è·¯å¾„ï¼‰Â  Â  Â  Â  Â  Â  | âŒ ç¦æ­¢çŒœæµ‹ Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  | **exporters/reaper_auto_config.py** Â  Â  | 44Â  Â  | Path(__file__).parent.parent / "output"Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **exporters/reaper_automation.py**Â  Â  Â  | 248 Â  | Path(__file__).parent.parent / "output"Â  Â  Â  | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **exporters/reaper_headless_export.py** | 155 Â  | Path(__file__).parent.parent / "lua_scripts" | âŒ ç¦æ­¢ Path(__file__).parent |

Â  | **exporters/reaper_webui_export.py**Â  Â  | 190 Â  | Path(__file__).parent.parent / "lua_scripts" | âŒ ç¦æ­¢ Path(__file__).parent |

  

Â  **ğŸŸ¢ ä½é—®é¢˜ - å·¥å…·/æµ‹è¯•æ–‡ä»¶ï¼ˆå¯æš‚æ—¶å¿½ç•¥ï¼‰**

  

Â  ä»¥ä¸‹æ–‡ä»¶ä¸»è¦æ˜¯æµ‹è¯•æˆ–è¾…åŠ©å·¥å…·ï¼Œå¯¹ç”Ÿäº§ç¯å¢ƒè·¯å¾„ç®¡ç†å½±å“è¾ƒå°ï¼š

  

Â  - test_*.py - å¤šä¸ªæµ‹è¯•æ–‡ä»¶

Â  - check_*.py - æ£€æŸ¥è„šæœ¬

Â  - archives/* - å½’æ¡£çš„æ—§ä»£ç 

Â  - extract_temperament.py - æ•°æ®æå–å·¥å…·

Â  - mapper.py - ç‹¬ç«‹è¿è¡Œçš„å·¥å…·è„šæœ¬

  

Â  ---

Â  **äºŒã€è¿å"å•å‘æµåŠ¨"è¦æ±‚çš„å…·ä½“åˆ†æ**

  

Â  **å½“å‰æ··ä¹±çš„è·¯å¾„æµå‘**

  

Â  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  å½“å‰æ··ä¹±çš„è·¯å¾„æº Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

Â  â”‚ 1. Tauri å‘½ä»¤è¡Œå‚æ•° (ARGS.config__dir, ARGS.export__dir)Â  Â  Â  â”‚

Â  â”‚Â  Â  â”œâ”€â”€ capsule__api.py æ¥æ”¶ âœ…Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â””â”€â”€ ä½†æœ‰ fallback åˆ°é»˜è®¤å€¼ âŒÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚ 2. ç¯å¢ƒå˜é‡ os.getenv()Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ SYNESTH__CAPSULE__OUTPUT (capsule__scanner.py) Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  â”œâ”€â”€ DATABASE__PATH (å¤šå¤„) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â””â”€â”€ CAPSULE__ROOT (capsule__api.py)Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚ 3. Path(_**___file___**_).parent (40+ å¤„ä½¿ç”¨) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ utils.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ capsule__api.py Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  â”œâ”€â”€ capsule__scanner.py Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ anchor__editor__v2.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ routes/*.py Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â””â”€â”€ exporters/*.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚ 4. ç”¨æˆ·é…ç½®æ–‡ä»¶çŒœæµ‹Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ capsule__scanner.py çŒœæµ‹ config__dir ä½ç½®Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â””â”€â”€ macOS/Windows/Linux ä¸åŒè·¯å¾„Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚ 5. ç¡¬ç¼–ç é»˜è®¤å€¼ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ 'output' ç›®å½•Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â”œâ”€â”€ 'database/capsules.db' Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  â””â”€â”€ '../Reaper__Sonic__Capsule'Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜_

  

Â  **åº”è¯¥çš„è·¯å¾„æµå‘**

  

Â  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  åº”è¯¥çš„å•å‘è·¯å¾„æµåŠ¨ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚ Â  Tauri (Rust)Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚ Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚ Â  Â  Â  â”œâ”€â”€ --capsule-dir â”€â”€â” Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚ Â  Â  Â  â”œâ”€â”€ --config-dir â”€â”€â”€â”€â”¼â”€â”€â†’ Python (sys.argv)Â  Â  Â  Â  Â  â”‚

Â  â”‚ Â  Â  Â  â””â”€â”€ --export-dir â”€â”€â”€â”˜ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â–¼Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Python PathManager Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (å•ä¾‹ï¼Œä» ARGS åˆå§‹åŒ–)Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â–¼Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚

Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ç”Ÿæˆ export__config.jsonÂ  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (åŒ…å«æ‰€æœ‰ç»å¯¹è·¯å¾„) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â–¼Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Lua è„šæœ¬è¯»å– JSON é…ç½®Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (ä¸¥ç¦è‡ªå·±è®¡ç®—è·¯å¾„) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â”‚Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚_

Â  _â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜_

  

Â  ---

Â  **ä¸‰ã€è¿å"ç»Ÿä¸€æ ‡å‡†"è¦æ±‚çš„é—®é¢˜**

  

Â  **è·¯å¾„åˆ†éš”ç¬¦é—®é¢˜**

  

Â  å½“å‰ä»£ç ä½¿ç”¨ Path å¯¹è±¡ï¼Œåœ¨ Windows ä¸Šä¼šè‡ªåŠ¨ä½¿ç”¨åæ–œæ  \ï¼Œè¿å"ç»Ÿä¸€ä½¿ç”¨æ­£æ–œæ "çš„è¦æ±‚ã€‚

  

Â  **é—®é¢˜æ–‡ä»¶**:

Â  - capsule_api.py - å¤§é‡ä½¿ç”¨ Path æ“ä½œ

Â  - capsule_scanner.py - str(relative_path) å¯èƒ½äº§ç”Ÿåæ–œæ 

Â  - æ‰€æœ‰ä½¿ç”¨ Path çš„æ–‡ä»¶

  

Â  **æ•°æ®åº“è·¯å¾„å­˜å‚¨**

  

Â  **å½“å‰çŠ¶æ€**:

Â  - capsule_scanner.py:120 - âœ… æ­£ç¡®ä½¿ç”¨ç›¸å¯¹è·¯å¾„å­˜å‚¨

Â  - capsule_scanner.py:127 - file_path = str(relative_path)

  

Â  **é—®é¢˜**: å­—ç¬¦ä¸²åŒ–å¯èƒ½åœ¨ Windows ä¸Šäº§ç”Ÿåæ–œæ ï¼Œåº”è¯¥å¼ºåˆ¶ä½¿ç”¨æ­£æ–œæ ï¼š

Â  # åº”è¯¥æ”¹ä¸ºï¼š

Â  file_path = str(relative_path).replace('\\', '/')

  

Â  **API å“åº”è·¯å¾„**

  

Â  **é—®é¢˜æ–‡ä»¶**: routes/library_routes.py

  

Â  # ç¬¬ 104 è¡Œ

Â  capsule['local_rpp_path'] = str(rpp_path.resolve())

  

Â  **é—®é¢˜**: resolve() è¿”å›ç»å¯¹è·¯å¾„ï¼Œåœ¨ Windows ä¸Šä¼šåŒ…å«åæ–œæ å’Œé©±åŠ¨å™¨å­—æ¯ã€‚

  

Â  ---

Â  **å››ã€utils.py è·¯å¾„ç®¡ç†å™¨é—®é¢˜åˆ†æ**

  

Â  **å½“å‰ utils.py çŠ¶æ€**

  

Â  # utils.py å½“å‰å®ç°

Â  def get_resource_path(relative_path: str) -> Path:

Â  Â  Â  if getattr(sys, 'frozen', False):

Â  Â  Â  Â  Â  base_path = Path(sys._MEIPASS)Â  # PyInstaller æ‰“åŒ…å

Â  Â  Â  else:

Â  Â  Â  Â  Â  base_path = Path(__file__).parentÂ  # âŒ è¿åè¦æ±‚

Â  Â  Â  return base_path / relative_path

  

Â  **common.py ä¸­çš„è·¯å¾„ç®¡ç†å™¨ï¼ˆæœªè¢«æ­£ç¡®ä½¿ç”¨ï¼‰**

  

Â  # common.py å·²å®šä¹‰ä½†æœªè¢«ä½¿ç”¨

Â  CONFIG_DIR = None

Â  EXPORT_DIR = None

Â  RESOURCE_DIR = None

  

Â  def init_paths(config_dir, export_dir, resource_dir):

Â  Â  Â  global CONFIG_DIR, EXPORT_DIR, RESOURCE_DIR

Â  Â  Â  CONFIG_DIR = Path(config_dir)

Â  Â  Â  EXPORT_DIR = Path(export_dir)

Â  Â  Â  RESOURCE_DIR = Path(resource_dir)

  

Â  **é—®é¢˜**:

Â  - init_paths() å‡½æ•°å­˜åœ¨ä½†ä»æœªè¢«è°ƒç”¨

Â  - å…¨å±€å˜é‡æœªè¢«åˆå§‹åŒ–ï¼Œå¯¼å‡ºåæ¨¡å—ä½¿ç”¨æ—¶éƒ½æ˜¯ None

Â  - å„æ¨¡å—ç»§ç»­ä½¿ç”¨å„è‡ªçš„è·¯å¾„è·å–æ–¹å¼

  

Â  ---

Â  **äº”ã€éœ€è¦ä¿®å¤çš„å®Œæ•´æ–‡ä»¶æ¸…å•**

  

Â  **ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆæ ¸å¿ƒæœåŠ¡ï¼‰**

  

Â  | # Â  | æ–‡ä»¶Â  Â  Â  Â  Â  Â  Â  Â  | ä¿®å¤å†…å®¹ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  |-----|---------------------|--------------------------------------------|

Â  | 1 Â  | capsule_api.pyÂ  Â  Â  | ç§»é™¤æ‰€æœ‰ fallbackï¼Œå¼ºåˆ¶è¦æ±‚å‘½ä»¤è¡Œå‚æ•°Â  Â  Â  |

Â  | 2 Â  | capsule_scanner.pyÂ  | ç§»é™¤å¤šå±‚ fallbackï¼Œä½¿ç”¨ç»Ÿä¸€è·¯å¾„ç®¡ç†å™¨Â  Â  Â  |

Â  | 3 Â  | anchor_editor_v2.py | æ·»åŠ å‘½ä»¤è¡Œå‚æ•°ï¼Œç§»é™¤ Path(__file__).parent |

Â  | 4 Â  | utils.pyÂ  Â  Â  Â  Â  Â  | é‡å†™ä¸ºå•ä¾‹è·¯å¾„ç®¡ç†å™¨ï¼Œä» ARGS åˆå§‹åŒ– Â  Â  Â  |

Â  | 5 Â  | capsule_db.py Â  Â  Â  | schema è·¯å¾„ä»å‚æ•°ä¼ å…¥ï¼Œä¸ä½¿ç”¨ __file__ Â  Â  |

Â  | 6 Â  | auth.py Â  Â  Â  Â  Â  Â  | ç§»é™¤ Path(__file__).parent Â  Â  Â  Â  Â  Â  Â  Â  |

Â  | 7 Â  | sync_service.py Â  Â  | ç§»é™¤ Path(__file__).parent Â  Â  Â  Â  Â  Â  Â  Â  |

Â  | 8 Â  | common.py Â  Â  Â  Â  Â  | ç¡®ä¿è¢«æ­£ç¡®åˆå§‹åŒ–å’Œä½¿ç”¨ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

  

Â  **ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆè·¯ç”±å’Œå¯¼å‡ºå™¨ï¼‰**

  

Â  | # Â  | æ–‡ä»¶Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | ä¿®å¤å†…å®¹ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  |-----|-------------------------------------|----------------------------------|

Â  | 9 Â  | routes/library_routes.pyÂ  Â  Â  Â  Â  Â  | ä½¿ç”¨ç»Ÿä¸€è·¯å¾„ç®¡ç†å™¨ Â  Â  Â  Â  Â  Â  Â  |

Â  | 10Â  | routes/sync_routes.py Â  Â  Â  Â  Â  Â  Â  | ä½¿ç”¨ç»Ÿä¸€è·¯å¾„ç®¡ç†å™¨ï¼Œç§»é™¤è·¯å¾„çŒœæµ‹ |

Â  | 11Â  | exporters/reaper_bridge.pyÂ  Â  Â  Â  Â  | Lua è„šæœ¬è·¯å¾„ä»é…ç½®ä¼ å…¥ Â  Â  Â  Â  Â  |

Â  | 12Â  | exporters/reaper_automation.pyÂ  Â  Â  | ç§»é™¤ Path(__file__).parent Â  Â  Â  |

Â  | 13Â  | exporters/reaper_auto_config.py Â  Â  | ç§»é™¤ Path(__file__).parent Â  Â  Â  |

Â  | 14Â  | exporters/reaper_headless_export.py | ç§»é™¤ Path(__file__).parent Â  Â  Â  |

Â  | 15Â  | exporters/reaper_webui_export.pyÂ  Â  | ç§»é™¤ Path(__file__).parent Â  Â  Â  |

  

Â  **ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆå·¥å…·å’Œæµ‹è¯•ï¼‰**

  

Â  | # Â  | æ–‡ä»¶ Â  Â  Â  Â  Â  Â  Â  Â  Â  | ä¿®å¤å†…å®¹Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  |-----|------------------------|---------------------------------------|

Â  | 16Â  | mapper.pyÂ  Â  Â  Â  Â  Â  Â  | æ·»åŠ å‘½ä»¤è¡Œå‚æ•°æ”¯æŒÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  | 17Â  | extract_temperament.py | æ·»åŠ å‘½ä»¤è¡Œå‚æ•°æ”¯æŒÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  | 18Â  | anchor_generator.pyÂ  Â  | ç§»é™¤ BASE_DIR = Path(__file__).parent |

Â  | 19Â  | lens_history.pyÂ  Â  Â  Â  | ç§»é™¤ BASE_DIR = Path(__file__).parent |

Â  | 20Â  | service_manager.py Â  Â  | ç§»é™¤ BASE_DIR = Path(__file__).parent |

  

Â  ---

Â  **å…­ã€å…³é”®ä»£ç ç¤ºä¾‹ï¼ˆä¿®å¤å‚è€ƒï¼‰**

  

Â  **é”™è¯¯ç¤ºä¾‹ âŒ**

  

Â  # capsule_api.py å½“å‰ä»£ç 

Â  if ARGS.config_dir:

Â  Â  Â  CONFIG_DIR = Path(ARGS.config_dir)

Â  else:

Â  Â  Â  CONFIG_DIR = Path.home() / 'Library' / 'Application Support' / 'com.soundcapsule.app'Â  # fallback âŒ

  

Â  # capsule_scanner.py å½“å‰ä»£ç 

Â  def get_output_dir():

Â  Â  Â  export_dir = os.getenv('SYNESTH_CAPSULE_OUTPUT')

Â  Â  Â  if export_dir:

Â  Â  Â  Â  Â  return Path(export_dir)

Â  Â  Â  # ... å¤šå±‚ fallback é€»è¾‘ âŒ

Â  Â  Â  return get_resource_path("output")

  

Â  **æ­£ç¡®ç¤ºä¾‹ âœ…**

  

Â  # åº”è¯¥æ”¹ä¸ºï¼š

Â  if ARGS.config_dir is None:

Â  Â  Â  raise ValueError("é”™è¯¯ï¼š--config-dir å‚æ•°å¿…é¡»ç”± Tauri ä¼ é€’")

Â  CONFIG_DIR = Path(ARGS.config_dir)

  

Â  if ARGS.export_dir is None:

Â  Â  Â  raise ValueError("é”™è¯¯ï¼š--export-dir å‚æ•°å¿…é¡»ç”± Tauri ä¼ é€’")

Â  EXPORT_DIR = Path(ARGS.export_dir)

  

Â  # capsule_scanner.py åº”è¯¥æ”¹ä¸ºï¼š

Â  from path_manager import get_path_manager

  

Â  def get_output_dir():

Â  Â  Â  pm = get_path_manager()

Â  Â  Â  if pm.export_dir is None:

Â  Â  Â  Â  Â  raise RuntimeError("è·¯å¾„ç®¡ç†å™¨æœªæ­£ç¡®åˆå§‹åŒ–")

Â  Â  Â  return pm.export_dir

  

Â  ---

Â  **ä¸ƒã€æ€»ç»“**

  

Â  **ç»Ÿè®¡æ•°æ®**

  

Â  - **æ€»è®¡è¿è§„æ–‡ä»¶**: 20+ ä¸ª

Â  - **Path(file).parent ä½¿ç”¨**: 40+ å¤„

Â  - **os.getenv() ä½œä¸ºè·¯å¾„æº**: 10+ å¤„

Â  - **ç¡¬ç¼–ç é»˜è®¤å€¼**: 15+ å¤„

  

Â  **æœ€ä¸¥é‡çš„é—®é¢˜**

  

Â  1. **capsule_api.py** - ä¸»å…¥å£æ–‡ä»¶æœ‰å¤§é‡ fallback é€»è¾‘

Â  2. **capsule_scanner.py** - å¤æ‚çš„å¤šå±‚è·¯å¾„çŒœæµ‹

Â  3. **anchor_editor_v2.py** - å®Œå…¨ä¸æ¥æ”¶å‘½ä»¤è¡Œå‚æ•°

Â  4. **utils.py** - æ²¡æœ‰å®ç°å•ä¾‹è·¯å¾„ç®¡ç†å™¨